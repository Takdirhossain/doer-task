<div class="mt-5">
  <div class="flex flex-space-between mb-4">
    <h2 class="text-2xl font-bold">Student List</h2>
    <div class="flex gap-2">
      <button
        class="btn btn-primary flex flex-center gap-2"
        routerLink="/teacher/student-management/csv-import"
      >
        <mat-icon>download</mat-icon>
        <span>Import CSV</span>
      </button>
      <!-- <button class="btn btn-secondary flex flex-center gap-2" (click)="openAddStudentDialog()">
        <mat-icon>account_box</mat-icon>
        <span>Add Student</span>
      </button> -->
    </div>
  </div>

  <div *ngIf="loading" class="flex justify-center mt-10">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <div *ngIf="!loading">
<div class="flex gap-3 mt-3 flex-space-between align-center">
      <div class="flex gap-3 mt-3">
      <mat-form-field appearance="outline">
        <mat-label>Items per page</mat-label>
        <mat-select [value]="pagination.limit" (selectionChange)="onPageSizeChange($event.value)">
          <mat-option [value]="10">10</mat-option>
          <mat-option [value]="20">20</mat-option>
          <mat-option [value]="30">30</mat-option>
          <mat-option [value]="40">40</mat-option>
          <mat-option [value]="50">50</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div>
      <input type="text" placeholder="Search" class="searchinput"  [(ngModel)]="searchTerm"
  (ngModelChange)="onSearchChange($event)"/>

    </div>
</div>
    <div class="table-container">
      <div class="overflow-x-auto">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-full">
          <ng-container matColumnDef="rollNumber">
            <th mat-header-cell *matHeaderCellDef class="w-16 text-center">Roll No</th>
            <td mat-cell *matCellDef="let student" class="text-center">
              {{ student.rollNumber }}
            </td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let student" class="font-medium">
              {{ student.firstName }} {{ student.lastName }}
            </td>
          </ng-container>
          <ng-container matColumnDef="username">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let student" class="font-medium">
              {{ student.user?.username }}
            </td>
          </ng-container>

          <ng-container matColumnDef="class">
            <th mat-header-cell *matHeaderCellDef class="w-20">Class</th>
            <td mat-cell *matCellDef="let student">{{ student.class }}</td>
          </ng-container>

          <ng-container matColumnDef="mobileNumber">
            <th mat-header-cell *matHeaderCellDef class="w-32">Mobile</th>
            <td mat-cell *matCellDef="let student">
              {{ student.user?.mobileNumber || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef class="w-40">Email</th>
            <td mat-cell *matCellDef="let student">
              {{ student.user?.email || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="address">
            <th mat-header-cell *matHeaderCellDef>Address</th>
            <td mat-cell *matCellDef="let student" class="max-w-xs truncate">
              {{ student.address }}
            </td>
          </ng-container>



          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns" class="hover:bg-gray-50"></tr>
        </table>

        <div *ngIf="dataSource.data.length === 0" class="text-center py-8">
          <p class="text-gray-500">No students found.</p>
        </div>
      </div>

      <mat-paginator
        [length]="pagination.total"
        [pageIndex]="pagination.page - 1"
        [pageSize]="pagination.limit"
        [pageSizeOptions]="[10, 20, 30, 40, 50]"
        (page)="onPageChange($event)"
        class="mt-3"
      >
      </mat-paginator>
    </div>
  </div>
</div>
